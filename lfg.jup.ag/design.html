
<!DOCTYPE html
<!-- Mirrored from lfg.jup.ag/design by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Feb 2024 08:39:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LFG Price Curve Modeling</title>
    <style>
        .banner {
            background-color: #4caf50; 
            color: white;
            text-align: center; 
            padding: 10px 0; 
            font-size: 20px; 
        }
        body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #1F2935;
        color: #ffffff;
        margin: 0;
        padding: 20px;
        }
        .container {
        max-width: 1200px;
        margin: auto;
        }
        .card {
        background-color: #344154;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        }
        .card h2 {
        color: #ffffff;
        margin-top: 0;
        }
        input, button, select, canvas {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 5px;
        border: none;
        }
        button {
        background-color: #4caf50;
        color: white;
        cursor: pointer;
        }
        button:hover {
        background-color: #45a049;
        }
        table {
        width: 100%;
        border-collapse: collapse;
        }
        table, th, td {
        border: 1px solid #333;
        }
        th, td {
            text-align: center;
            padding: 12px;
        }
        th {
        background-color: #333;
        }
        tr:nth-child(even) {
        background-color: #2C394C;
        }
        .small-grey-text {
        font-size: smaller;
        color: #9c9c9f; 
    }
    .grey-text {
        color: #9c9c9f; 
    }
    .grey-text span {
        color:#ffffff;
    }
    </style>
    </head>
    <body>
    <div class="banner">
        <a href="https://www.jupresear.ch/t/jupiter-launchpad-modelling-an-inituitive-way-to-design-launch-liquidity-curves/403?u=joshua" style="color: #fff" target="_blank">Read The Forum Post Here</a>
    </div>

    <div class="container">
        <div class="card">
            <h2>Jupiter LFG Curve Modelling</h2>
            <p>Jupiter is building a new way of organically launching projects and tokens. Part of this platform is a <a href="https://app.meteora.ag/dlmm" style="color: #19C5E4" target="_blank">Meteora's DLMM Pool</a> pools to provide single-sided liquidity in a way that builds early backstop liquidity and also allows bootstrap organic liquidity. At the end of the launch period, liquidity transitions from this DLMM pool into organic liquidity across venues.</p>
            <p>This site allows you to play around with various inputs and understand how they influence token launching and bootstrapping. All the following parameters affect the price curve, liquidity distribution, and DLMM pools differently. In order to design a liquidity curve that achieves your desired outcome of bootstrapping a new project organically, play around with the input parameters to generate different curves and understand the trade-offs of every decision. Observe how changing the inputs changes the DLMM pool and the value in each bin.</p>
            <p>Play around with the input parameters to generate different curves and understand the trade-offs of every decision.Observe how changing the inputs changes the DLMM pool and the value in each bin.</p>
            <p>These input parameters can then be used to generate a Meteora DLMM Pool to precisely deploy liquidity and to achieve the desired outcome of bootstrapping a new project organically. Observe how changing the inputs changes the DLMM Pool and the value in each bin.</p>
        </div>
            
        <div class="card">
        <h2>Input Parameters</h2>
        <form id="parameterForm" onsubmit="display(); return false;">
            <label class="grey-text" for="a">
                <span>Curvature:</span> Determines how liquidity is distributed across the price range
            </label>
            <input type="number" id="k" name="k" step="0.05" value="0.4" min="0" max="100">
            
            <label for="i">Initial Price</label>
            <input type="number" id="i" name="i" step="0.0000001" value="0.1" min="0" max="10">
            
            <label for="m">Maximum Price</label>
            <input type="number" id="m" name="m" step="0.0000001" value="1" min="0" max="100" >
    
            <label class="grey-text" for="a">
                <span>Initial No. of Tokens in the pool</span> (in Millions)
            </label>
            <input type="number" id="a" name="a" step="0.01" value="500" min="1" max="100000000" >
    
            <label class="grey-text" for="a">
                <span>Bin Step:</span> Determines the granularity of the price by changing the number of DLMM bins available
            </label>
            <input type="number" id="bps" name="bps" step="1" value="25" min="1" max="400" >
            
            <button type="submit">Submit</button>
        </form>
        <p id="display"></p>
        </div>
        
        <div class="card">
        <h3>   Price Curve</h3>
        <p class="small-grey-text">Illustrates how the price of the token changes over time as tokens are withdrawn from the pool.</p>
        <canvas id="myChart1"></canvas>
        <h3>   Liquidity Distribution</h3>
        <p class="small-grey-text">Illustrates how much liquidity is available at each price point.</p>
        <canvas id="myChart2"></canvas>
        <h3>   DLMM Bins</h3>
        <p class="small-grey-text">Illustrates what the end result in Meteora DLMM bins.</p>
        <p class="small-grey-text">Numbers shown are for illustration purposes and may deviate.</p>
        <canvas id="myBarChart"></canvas> 
        <p class="small-grey-text"><a href="https://docs.meteora.ag/dlmm/dlmm-overview" style="color: #19C5E4" target="_blank">Learn more about Meteora's DLMM pools here</a></p>
        </div>
    
        <div class="card">
        <h2>Tokens Table</h2>
        <p class="small-grey-text">Shows the relation between the amount of USDC present in the liquidity pool as more tokens are withdrawn by buyers.</p>
        <table id="soldTokensTable">
            <tbody>
            </tbody>
        </table>
        </div>
    
        <div class="card">
        <h2>Price Table</h2>
        <p class="small-grey-text">Shows the relation between the amount of USDC present in the liquidity pool at various price levels.</p>
        <table id="priceTokenTable">
            <tbody>
            </tbody>
        </table>
        </div>
    </div>
    
    <script src="../cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
            
        function display() {
        var k = parseFloat(document.getElementById("k").value);
        var i = parseFloat(document.getElementById("i").value);
        var M = parseFloat(document.getElementById("m").value);
        var A = parseFloat(document.getElementById("a").value);
        var binStep = parseFloat(document.getElementById("bps").value);
        var flat=false
        if (M < i) {
            document.getElementById("display").innerText = "Error: Maximum Price must be greater or equal to Initial Price.";
            return; 
        }else if (M==i && k!=0 ) {
            document.getElementById("display").innerText = "Error: Curvature must be 0 when Maximum and Initial Price are equal";
            return; 

        }else if (M!=i && k==0 ) {
            document.getElementById("display").innerText = "Error: Maximum and Initial Price must be equal when Curvature is 0";
            return; 

        }else if (M==i && k==0 ) {
            var flat = true
        }

    
        var f = parseFloat((M - i).toFixed(8));
        function myFormula(c) {
            return f * Math.pow((c / A), k) + i;
        }
        function integrate(upper, lower) {
            let u = f * Math.pow(A, -k) * Math.pow(upper, k + 1) / (k + 1) + i * upper;
            let l = f * Math.pow(A, -k) * Math.pow(lower, k + 1) / (k + 1) + i * lower;
            return u - l;
        }
        function reverse_formula(p) {
            return A * Math.pow(((p- i) / f), 1 / k);
        }
        function liquidity(p) {
            return A * Math.pow((p - i), (1 / k) - 1) / (k * Math.pow(f, 1 / k));
        }
    
        function getIdFromPrice(price, binStep){
            return Math.trunc(Math.log(price) / Math.log(1 + binStep / 10000));
        }
        function getPriceFromId(binId, binStep) {
            return Math.pow(1 + binStep / 10000, binId);
        }
        function binTokens(id){
            let C = Math.pow(((Math.pow((1 + binStep/10000), id)-i)/f),(1/k))*A;
            return C
        }
        prices=[]
        heights=[]
        let minBinId=getIdFromPrice(i,binStep)
        let maxBinId=getIdFromPrice(M,binStep)
        diff=maxBinId-minBinId
        total=0
        let BinNum = minBinId;
        console.log(getPriceFromId(BinNum,binStep))
        if (flat) {
            prices.push(i)
            heights.push(i*A)
        }
        else{
        while (BinNum <= maxBinId) {
            c1=getPriceFromId(BinNum,binStep)
            total+=(binTokens(BinNum+1)-binTokens(BinNum))
            heights.push((binTokens(BinNum+1)-binTokens(BinNum))*c1)
            prices.push(parseFloat(Number(c1.toPrecision(5))))
            BinNum++
             
    
            }
        }
        console.log(total)
        var LDstep = f/100
        const ctx1 = document.getElementById('myChart1');
        const ctx2 = document.getElementById('myChart2');
        const ctx3 = document.getElementById('myBarChart')

        const numPoints = 101;
        const numPoints2 = 101;
        
        const dataPoints = Array.from({ length: numPoints }, (_, index) => index * (A / (numPoints-1)));
        if (flat){
            var dataPoints2 = [{ x: i, y: 0 },{ x: i, y: A }];
        }else{
            var dataPoints2 = Array.from({ length: numPoints2 }, (_, index) => +(i + index * LDstep).toFixed(9));
        }
        
        const data1 = {
            labels: dataPoints,
            datasets: [{
                label: 'Price Curve',
                pointRadius: 0,
                data: flat ? new Array(dataPoints.length).fill(M) : dataPoints.map(x => myFormula(x)),
                borderColor: '#FCC663',
                borderWidth: 2
            }]
        };
        const data2 = {
            labels: dataPoints2,
            datasets: [{
                label: 'Liquidity Distribution',
                pointRadius: 0,
                data: flat ? [{x: i, y: 0}, {x: i, y: A/2}, {x: i, y: A}] : dataPoints2.map(x => ({ x: x, y: liquidity(x) })),
                borderColor: '#FCC663',
                borderWidth: 2
            }]
        };
    
        const data3 = {
            labels: prices,
            datasets: [{
                label: 'Bins',
                data: heights,
                barThickness: flat ? 40 : undefined
            }]
        };
    
        const options1 = {
            scales: {
                x: {
                    ticks: {
                        color: 'white'
                    },
                    title: {
                        display: true,
                        text: 'Cumulative Tokens Withdrawn (In Millions)',
                        color: 'white', 
                        font: {
                            size: 16
                        }
                    }
                },
                y: {
                    ticks: {
                        color: 'white'
                    },
                    title: {
                        display: true,
                        text: 'Price',
                        color: 'white',
                        font: {
                            size: 16
                        }
                    }
                }
                
            },
            plugins: {
                legend: {
                    labels: {
                        color: 'white'
                    }
                }
            }
        };
        const options2 = {
            scales: {
                x: {
                    type: 'linear',
                    position: 'bottom',
                    min: flat ? i - 0.05 : i,
                    max: flat ? i + 0.05 : M,
                    ticks: {
                        color: 'white'
                    },
                    title: {
                        display: true,
                        text: 'Price',
                        color: 'white',
                        font: {
                            size: 16
                        }
                    }
                },
                y: {
                    beginAtZero: true,
                    ticks: {
                        color: 'white'
                    },
                    title: {
                        display: true,
                        text: 'Liquidity',
                        color: 'white', 
                        font: {
                            size: 16
                        }
                    }
                }
            },
            plugins: {
                legend: {
                    labels: {
                        color: 'white'
                    }
                }
            }
        };
    
        const options3 = {
            scales: {
                x: {
                    ticks: {
                        color: 'white'
                    }
                },
                y: {
                    beginAtZero: true,
                    ticks: {
                        color: 'white'
                    }
                }
            },
            plugins: {
                legend: {
                    labels: {
                        color: 'white'
                    }
                },
                tooltip: {
                    titleFont: {
                        color: 'white' 
                    },
                    bodyFont: {
                        color: 'white'
                    },
                    callbacks: {
                        label: function(context) {
                            let label = Number( context.chart.data.labels[context.dataIndex].toPrecision(5) )
;
                            let value = Number(context.dataset.data[context.dataIndex].toPrecision(5) )
;;
                            return `Price: ${label}, Value in Bin: ${value}`;
                        }
                    }
                }
            }
        };
    
    
    
    
        if (ctx1.chartInstance) {
            ctx1.chartInstance.destroy();
        }
        if (ctx2.chartInstance) {
            ctx2.chartInstance.destroy();
        }
        if (ctx3.chartInstance) {
            ctx3.chartInstance.destroy();
        }
    
    
        ctx1.chartInstance = new Chart(ctx1.getContext('2d'), { type: 'line', data: data1, options: options1 });
        ctx2.chartInstance = new Chart(ctx2.getContext('2d'), { type: 'line', data: data2, options: options2 });
        ctx3.chartInstance = new Chart(ctx3.getContext('2d'), { type: 'bar', data: data3, options: options3 });
        
        const soldTokensTable = document.getElementById('soldTokensTable');
        soldTokensTable.innerHTML = ''; 
        var row = document.createElement('tr');
        row.innerHTML = `<td>Tokens Withdrawn (In Millions)</td> <td>Price</td> <td>USDC in the Pool (In Millions)</td>`; 
        soldTokensTable.append(row)
        const step = parseFloat((A/10).toFixed(5));
        let tokensWithdrawn = 0;
        while (tokensWithdrawn <= A ) {
            let price = myFormula(tokensWithdrawn);
            price = parseFloat(price.toFixed(8));
            n = parseFloat(tokensWithdrawn.toFixed(8));
            let USDCInPool = parseFloat((integrate(n, 0 )).toFixed(8))
            var row = document.createElement('tr');
            row.innerHTML = `
                <td>${Number(tokensWithdrawn.toPrecision(5))}</td>
                <td>${Number(price.toPrecision(5))}</td>
                <td>${Number(USDCInPool.toPrecision(5))}</td>
            `;   
            soldTokensTable.appendChild(row);
            tokensWithdrawn += step;
        }
        const step2= Math.floor(f*10000000000)/100000000000
        const priceTokenTable = document.getElementById('priceTokenTable');
        priceTokenTable.innerHTML = ''; 
        var row = document.createElement('tr');
        row.innerHTML = `<td>Price</td> <td>Tokens Withdrawn (In Millions)</td> <td>USDC in the Pool (In Millions)</td>`;   
        priceTokenTable.appendChild(row);
        r=0
        let price = i;
        if (flat){
            var row = document.createElement('tr');
            row.innerHTML = `
                <td>${Number(price.toPrecision(5))}</td>
                <td>${Number(A.toPrecision(5))}</td>
                <td>${Number(price*A.toPrecision(5))}</td>
            `;
            priceTokenTable.appendChild(row);
        }
        else{
            while (r <= 10) {
                price = parseFloat(price.toFixed(8));
                tokensWithdrawn = reverse_formula(price); 
                tokensWithdrawn = parseFloat(tokensWithdrawn.toFixed(8));
                USDCInPool = parseFloat((integrate(tokensWithdrawn,0)).toFixed(8))
                var row = document.createElement('tr');
                row.innerHTML = `
                    <td>${Number(price.toPrecision(5))}</td>
                    <td>${Number(tokensWithdrawn.toPrecision(5))}</td>
                    <td>${Number(USDCInPool.toPrecision(5))}</td>
                `;
                priceTokenTable.appendChild(row);
                price += step2;
                r++
            }
        }
    
        document.getElementById("display").innerText = "Curvature = " + k + " Inital Price = " + i + "  Maximum Price = " + M + "  Range = " + f;
        }
        function getURLParameters() {
            var params = {};
            if (window.location.hash) {
                var hash = window.location.hash.substring(1); // Remove '#'
                hash.split('&').forEach(function (item) {
                    let pair = item.split('=');
                    if (pair.length == 2) {
                        params[pair[0]] = decodeURIComponent(pair[1]);
                    }
                });
            }
            return params;
        }

        window.onload = function() {
            var params = getURLParameters();
            console.log(params)
            if (params.k) document.getElementById('k').value = params.k;
            if (params.i) document.getElementById('i').value = params.i;
            if (params.m) document.getElementById('m').value = params.m;
            if (params.a) document.getElementById('a').value = params.a;
            if (params.bps) document.getElementById('bps').value = params.bps;
            display();
        };

        document.addEventListener('DOMContentLoaded', function() {
            var form = document.getElementById('parameterForm');

            form.addEventListener('submit', function(event) {
                event.preventDefault();
                var k = document.getElementById('k').value;
                var i = document.getElementById('i').value;
                var m = document.getElementById('m').value;
                var a = document.getElementById('a').value;
                var bps = document.getElementById('bps').value;
                var hashString = `#k=${encodeURIComponent(k)}&i=${encodeURIComponent(i)}&m=${encodeURIComponent(m)}&a=${encodeURIComponent(a)}&bps=${encodeURIComponent(bps)}`;
                
                window.location.hash = hashString;
                display(); 
            });

            display(); 
        });
    </script>
    <script defer src="https://static.cloudflareinsights.com/beacon.min.js/v84a3a4012de94ce1a686ba8c167c359c1696973893317" integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA==" data-cf-beacon='{"rayId":"85019b239d82d7a1","b":1,"version":"2024.2.0","token":"ac4d3bdcea374badae66954bff9555fc"}' crossorigin="anonymous"></script>
</body>
    
<!-- Mirrored from lfg.jup.ag/design by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Feb 2024 08:39:57 GMT -->
</html>
    